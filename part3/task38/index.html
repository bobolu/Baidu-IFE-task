<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Task38 UI组件之排序表格</title>
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet">
    <style type="text/css">
    td {
        border: 1px solid black;
        width: 100px;
    }
    
    table {
        border-collapse: collapse;
        text-align: center;
    }
    </style>
</head>

<body>
    <div id="table"></div>
    <script type="text/javascript">
    var TableTool = {
        init: function(param) {
            return;
        },
        createTable: function() {
            var student = [];
            var Student = function(name, 语文, 数学, 英语) {
                this.name = name;
                this.语文 = 语文;
                this.数学 = 数学;
                this.英语 = 英语;
            }

            student[0] = new Student("小明", 20, 90, 70);
            student[1] = new Student("小红", 90, 60, 90);
            student[2] = new Student("小虹", 60, 100, 70);

            var table_thead = ["姓名", "语文", "数学", "英语"];

            var render = function() {
                // var div = document.createElement("div");
                var table = document.createElement("table");
                var thead = document.createElement("thead");
                var thead_tr = document.createElement("tr");

                var table_html = "";
                for (var i = 0; i < table_thead.length; i++) {
                    table_html += "<td name='" + table_thead[i] + "'>" + table_thead[i] + "<i class='fa fa-arrow-up' aria-hidden='true' id='sort" + table_thead[i] + "down'></i><i class='fa fa-arrow-down' aria-hidden='true' id='sort" + table_thead[i] + "up'></i></td>";
                }
                thead.innerHTML = table_html;

                table.appendChild(thead);

                var tbody = document.createElement("tbody");

                var tbody_obj = {
                    1: student[0],
                    2: student[1],
                    3: student[2]
                };

                var tbody_html = "";
                for (var i = 1; i < table_thead.length; i++) {
                    tbody_html += "<tr><td>" + tbody_obj[i].name + "</td><td>" + tbody_obj[i].语文 + "</td><td>" + tbody_obj[i].数学 + "</td><td>" + tbody_obj[i].英语 + "</td></tr>";
                }

                tbody.innerHTML = tbody_html;

                table.appendChild(tbody);

                // document.body.appendChild(div);
                document.getElementById("table").appendChild(table);


                document.getElementById("sort语文up").addEventListener("click", function() {
                    resetTable();
                    ascendingSort(student, "语文");
                    render();
                }, false);
                document.getElementById("sort数学up").addEventListener("click", function() {
                    resetTable();
                    ascendingSort(student, "数学");
                    render();
                }, false);
                document.getElementById("sort英语up").addEventListener("click", function() {
                    resetTable();
                    ascendingSort(student, "英语");
                    render();
                }, false);
                document.getElementById("sort语文down").addEventListener("click", function() {
                    resetTable();
                    descendingSort(student, "语文");
                    render();
                }, false);
                document.getElementById("sort数学down").addEventListener("click", function() {
                    resetTable();
                    descendingSort(student, "数学");
                    render();
                }, false);
                document.getElementById("sort英语down").addEventListener("click", function() {
                    resetTable();
                    descendingSort(student, "英语");
                    render();
                }, false);
            }
            render();

        },
    }

    TableTool.createTable();
    /**
     * 排序函数
     * @param  {array} data    要参照的数组
     * @param  {obj} courese 要参照的科目
     * @return {array}         返回排序好之后的数组
     */
    function ascendingSort(data, courese) {
        data.sort(function(a, b) {
            return a[courese] - b[courese];
        });
        return data;
    }

    function descendingSort(data, courese) {
        data.sort(function(a, b) {
            return b[courese] - a[courese];
        });
        return data;
    }


    function resetTable() {
        document.getElementById("table").innerHTML = "";
    }
    </script>
</body>

</html>
